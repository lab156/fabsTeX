# fabsTeX: Create a stacks-like website for your LaTeX document

## fabsTeX _does_:
Given a tex file fabsTeX creates a flask app in the flavor of the stacks project website.

## Usage:
To use fabsTeX simply run on the commandline
```shell
$fabsTeX texfile -output dir
```

## Installation
Assuming you have a working installation of:
* [plastex](https://github.com/kodyvajjha/plastex.git) 
* [gerby-website](https://github.com/gerby-project/gerby-website.git)

Just clone the repo in your local machine: 
```shell
https://github.com/lab156/fabsTeX.git
```
## Outline of the general algorithm:
At this point, we should have a `tex` document which is user supplied. 

### Processing of the TeX file:

1. Comment out all imports of `tikz-cd`,`tikz` and `epstopdf`. 
2. (Optional but strongly recommended!) In the TeX file, add a `\label` to every section, subsection, definition, theorem, lemma, proposition, items of an `enumerate` list or a `itemize` list. The names of these `\label`s should follow the following convention (here `n` is a counter):
    - Theorem -> `\label{thm-n}` 
    - Section -> `\label{sec-n}`
    - Subsection -> `\label{subsec-n}`
    - Subsubsection -> `\label{subsubsec-n}`
    - Proposition -> `\label{prop-n}`
    - Lemma -> `\label{lem-n}`
    - Items of an `enumerate` -> `\label{enum-item-n}`
    - Items of an `itemize` -> `\label{itemize-item-n}`
3. Use the `tagger.py` file to assign Gerby-tags to the previously defined labels. 
4. Use the `labeller.py` file to modify the TeX file to enhance each `\label{}` generated in step 2 with the tag generated in step 3. (This is what produces the clickable links within the pdf of the Kerodon project). 
5. Place the labels and tags side-by-side, comma separated in a file called `stacks.tags`, which should be in the same directory as the TeX file. 
### Running plasTeX:
6. With the processed TeX file and the `TAGS` file in hand, run ```plastex --renderer=Gerby tex-file.tex``` on it so that it produces it's output.

### Running gerby flask app:
7. Rename:
    - The file `tex-file.paux` to `stacks.paux`.
    - The directory `tex-file` to `stacks`.
8. Inside the directory `.../gerby-website/gerby/tools/`, make the following softlinks:
    - `ln -s ../../../stacks.paux stacks.paux`
    - `ln -s ../../../stacks stacks`
    - `ln -s ../../../stacks.tags stacks.tags`
9. Run `python update.py`.
10. Go back to the `.../gerby-website` and run `export FLASK_APP=gerby` and `flask run`. 


Once this is done, the gerby-tags so generated can be used while formalizing. They can be referenced in the Lean user attribute as ```@[fabstract GERBY_TAG_HERE]```. We could then write helper functions within Lean to upload the formal statement of the tagged definition/theorem/lemma to it's appropriate webpage, which is generated by the flask app. 



